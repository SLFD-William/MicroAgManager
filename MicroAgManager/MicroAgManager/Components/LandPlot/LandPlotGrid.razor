@using Domain.Models
@using Microsoft.AspNetCore.Components.QuickGrid
@using Microsoft.EntityFrameworkCore


<QuickGrid Theme="microagmanager" @ref=plotGrid TGridItem=LandPlotModel Virtualize=true Items="Items">
    
    @if (ShowFarmColumn)
    {
        <PropertyColumn Property="@(p => p.Farm.Name)" Title="Farm" Sortable="true">
            <ColumnOptions>
                <div class="search-box">
                    <input type="search" autofocus @bind="farmNameFilter" @bind:event="oninput" placeholder="Farm..." />
                </div>
            </ColumnOptions>
        </PropertyColumn>
    }
    @if (ShowUsageColumn)
    {
        <PropertyColumn Property
        ="@(p => p.Usage)" Title
        ="Usage" Sortable
        ="true">
            <ColumnOptions>
            <div class="search-box">
                <input type="search" autofocus @bind="usageFilter" @bind:event="oninput" placeholder="Farm..." />
            </div>
        </ColumnOptions>
    </PropertyColumn>
    }
    <PropertyColumn Property="@(p => p.ParentPlotName)" Title="Parent Plot" Sortable="true">
        <ColumnOptions>
            <div class="search-box">
                <input type="search" autofocus @bind="parentPlotNameFilter" @bind:event="oninput" placeholder="Parent Plot..." />
            </div>
        </ColumnOptions>
    </PropertyColumn>
    
    <PropertyColumn Property="@(p => p.Name)" Title="Name" Sortable="true">
        <ColumnOptions>
            <div class="search-box">
            <input type="search" autofocus @bind="plotNameFilter" @bind:event="oninput" placeholder="Farm..." />
            </div>
        </ColumnOptions>
    </PropertyColumn>
    <PropertyColumn Property="@(p => p.Area)" Title="Area" Sortable="true">
        <ColumnOptions>
            @* <div class="search-box">
            <input type="search" autofocus @bind="farmNameFilter" @bind:event="oninput" placeholder="Farm..." />
            </div> *@
        </ColumnOptions>
    </PropertyColumn>
     <PropertyColumn Property="@(p => p.AreaUnit.Symbol)" Title="Area Unit" Sortable="true">
        <ColumnOptions>
            @* <div class="search-box">
            <input type="search" autofocus @bind="farmNameFilter" @bind:event="oninput" placeholder="Farm..." />
            </div>         *@
        </ColumnOptions>
    </PropertyColumn>


</QuickGrid>
@code {
    [Parameter] required public IQueryable<LandPlotModel> Items { get; set; }
    QuickGrid<LandPlotModel> plotGrid;


    [Parameter] public bool ShowFarmColumn { get; set; } = true;
    [Parameter] public Action<string> farmNameFilterChanged { get; set; }
    private string _farmNameFilter;
    string farmNameFilter
    {
        get => _farmNameFilter; set
        {
            farmNameFilterChanged.Invoke(value);
            _farmNameFilter = value;
        }
    }

    [Parameter] public Action<string> plotNameFilterChanged { get; set; }
    private string _plotNameFilter;
    string plotNameFilter
    {
        get => _plotNameFilter; set
        {
            plotNameFilterChanged.Invoke(value);
            _plotNameFilter = value;
        }
    }
    [Parameter] public Action<string> parentPlotNameFilterChanged { get; set; }
    private string _parentPlotNameFilter;
    string parentPlotNameFilter
    {
        get => _parentPlotNameFilter; set
        {
            parentPlotNameFilterChanged.Invoke(value);
            _parentPlotNameFilter = value;
        }
    }


    [Parameter] public bool ShowUsageColumn { get; set; } = true;
    [Parameter] public Action<string> usageFilterChanged { get; set; }
    private string _usageFilter;
    string usageFilter
    {
        get => _usageFilter; set
        {
            usageFilterChanged.Invoke(value);
            _usageFilter = value;
        }
    }


}